<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üåæ GDSX FARM ULTRA++</title>
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

<style>
body {
  background: radial-gradient(circle at top,#000 40%,#111 100%);
  color:#fff; font-family:"Poppins","Noto Sans Thai",sans-serif;
  text-align:center; padding:80px 20px; margin:0;
}
h1 {color:#ffd700;text-shadow:0 0 15px #ffd700,0 0 30px #ffb700;}
.panel {
  display:inline-block; background:#111; border:1px solid #333;
  border-radius:12px; padding:25px 30px; margin:15px; min-width:260px;
  box-shadow:0 0 15px rgba(255,215,0,0.2);
}
input {
  padding:10px 12px; border-radius:8px; border:none; width:180px;
  text-align:center; font-size:1rem;
}
button {
  background:#ffd700; border:none; padding:12px 22px;
  border-radius:8px; font-weight:bold; cursor:pointer;
  margin:8px; transition:0.25s;
}
button:hover {box-shadow:0 0 20px #ffd700;}
#connect {background:#00ffd5;color:#000;}
.footer {margin-top:40px;color:#888;font-size:0.8rem;}
</style>
</head>

<body>
  <h1>üåæ GDSX FARM ULTRA++</h1>
  <p>The Future of Digital Gold ‚Äî ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•‡πÅ‡∏´‡πà‡∏á‡∏¢‡∏∏‡∏Ñ‡πÉ‡∏´‡∏°‡πà</p>

  <div id="walletInfo" class="panel">
    <p>Wallet: <span id="wallet">Not Connected</span></p>
    <p>Your Stake: <span id="stake">0</span> GDSX</p>
    <p>Pending Rewards: <span id="rewards">0</span> GDSX</p>
  </div>

  <div class="panel">
    <input type="number" id="amount" placeholder="Enter amount GDSX">
    <div>
      <button onclick="deposit()">Deposit</button>
      <button onclick="withdraw()">Withdraw</button>
      <button onclick="claim()">Claim</button>
    </div>
  </div>

  <div class="panel">
    <button id="connect" onclick="connectWallet()">üîó Connect Wallet</button>
    <a href="index.html"><button>üè† Back Home</button></a>
  </div>

  <div class="footer">¬© 2025 GDSX Finance ‚Äî Powered by Gold Digital System X</div>


<script>
// ========= Contract Setup =========
const TOKEN = "0xFa9d637329C79bCa321e2Bf0179ae78Bcb3d235a";
const FARM  = "0x5ab799F6366cEBFa80706b11CC6754C5B48e69a4";

const farmABI = [
  "function deposit(uint256 amount) external",
  "function withdraw(uint256 amount) external",
  "function pendingReward(address user) public view returns(uint256)",
  "function users(address user) public view returns(uint256 amount, uint256 rewardDebt)"
];

const tokenABI = [
  "function approve(address spender, uint256 amount) external returns(bool)",
  "function allowance(address owner, address spender) external view returns(uint256)",
  "function balanceOf(address owner) external view returns(uint256)"
];

let provider, signer, farm, token, user;


// ========= Connect Wallet =========
async function connectWallet() {
  if (!window.ethereum) return alert("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á MetaMask");

  provider = new ethers.providers.Web3Provider(window.ethereum);
  await provider.send("eth_requestAccounts", []);
  signer = provider.getSigner();
  user = await signer.getAddress();

  document.getElementById("wallet").textContent = user.slice(0,6)+"..."+user.slice(-4);

  farm  = new ethers.Contract(FARM, farmABI, signer);
  token = new ethers.Contract(TOKEN, tokenABI, signer);

  loadData();
}


// ========= Load Stake + Rewards =========
async function loadData() {
  if (!farm || !user) return;

  try {
    const info = await farm.users(user);
    const pending = await farm.pendingReward(user);

    document.getElementById("stake").textContent =
      parseFloat(ethers.utils.formatUnits(info.amount,18)).toFixed(4);

    document.getElementById("rewards").textContent =
      parseFloat(ethers.utils.formatUnits(pending,18)).toFixed(4);

  } catch (err) {
    console.log("Load error:", err);
  }
}


// ========= Deposit =========
async function deposit() {
  if (!signer) return alert("Connect wallet first");

  const amt = document.getElementById("amount").value;
  if (!amt || amt <= 0) return alert("Enter amount");

  const amountWei = ethers.utils.parseUnits(amt, 18);

  try {
    // approve ‡∏Å‡πà‡∏≠‡∏ô
    const allowance = await token.allowance(user, FARM);
    if (allowance.lt(amountWei)) {
      const tx1 = await token.approve(FARM, amountWei);
      await tx1.wait();
    }

    const tx = await farm.deposit(amountWei);
    await tx.wait();

    alert("‚úÖ Deposit Success!");
    loadData();

  } catch (err) {
    console.log(err);
    alert("‚ö†Ô∏è Deposit failed");
  }
}


// ========= Withdraw =========
async function withdraw() {
  if (!signer) return alert("Connect wallet first");

  const amt = document.getElementById("amount").value;
  if (!amt || amt <= 0) return alert("Enter amount");

  const amountWei = ethers.utils.parseUnits(amt, 18);

  try {
    const tx = await farm.withdraw(amountWei);
    await tx.wait();

    alert("‚úÖ Withdraw Success!");
    loadData();

  } catch (err) {
    console.log(err);
    alert("‚ö†Ô∏è Withdraw failed");
  }
}


// ========= Claim (withdraw 0) =========
async function claim() {
  if (!signer) return alert("Connect wallet first");

  try {
    const tx = await farm.withdraw(0);
    await tx.wait();

    alert("üéâ Rewards Claimed!");
    loadData();

  } catch (err) {
    console.log(err);
    alert("‚ö†Ô∏è Claim failed");
  }
}
</script>

</body>
</html>
