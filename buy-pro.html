<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üí∞ BUY GDSX PRO v3.1 ‚Äî CORS FIX</title>
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
<style>
:root{--gold:#ffd700;--neon:#00ffd5;}
body{
  background:radial-gradient(circle at top,#000 40%,#111 100%);
  color:#fff;font-family:"Poppins","Noto Sans Thai",sans-serif;
  text-align:center;overflow-x:hidden;min-height:100vh;margin:0;
}
.logo{width:90px;height:90px;border-radius:50%;margin-top:20px;
  box-shadow:0 0 30px rgba(255,215,0,.8);animation:spin 10s linear infinite;}
@keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}
h1{color:var(--gold);text-shadow:0 0 10px var(--gold);}
.panel{
  background:rgba(20,20,20,.9);border:1px solid var(--gold);
  border-radius:18px;padding:25px;margin:25px auto;
  width:90%;max-width:420px;box-shadow:0 0 15px rgba(255,215,0,.3);
}
input{width:80%;padding:12px;margin-top:10px;border-radius:10px;
  border:1px solid rgba(255,215,0,.3);background:#111;color:#fff;text-align:center;}
button{
  margin-top:15px;padding:12px 25px;border-radius:12px;cursor:pointer;font-weight:700;
  transition:.3s;
}
.buy{
  background:linear-gradient(90deg,#00ffcc,#00cc99);color:#111;border:none;
  box-shadow:0 0 20px rgba(0,255,204,.7);
}
.back{
  background:linear-gradient(90deg,#333,#555);
  color:var(--gold);border:1px solid var(--gold);
}
.toast{
  position:fixed;left:50%;bottom:60px;transform:translateX(-50%);
  background:rgba(20,20,20,.95);border:1px solid var(--gold);
  color:#fff;padding:10px 16px;border-radius:12px;
  box-shadow:0 0 12px rgba(255,215,0,.35);display:none;z-index:1600;font-size:.95em;
}
.toast.show{display:block;}
.wallet{
  position:fixed;top:10px;right:15px;background:rgba(30,30,30,.9);
  border:1px solid var(--gold);border-radius:10px;padding:6px 10px;
  color:var(--gold);font-size:.8em;text-shadow:0 0 5px var(--gold);
}
.balances{font-size:.9em;margin-top:8px;line-height:1.6em;}
footer{position:fixed;bottom:0;width:100%;height:30px;background:#111;
  border-top:1px solid rgba(255,215,0,.5);overflow:hidden;}
footer p{color:var(--gold);white-space:nowrap;font-size:.9em;font-weight:600;
  animation:scrollText 18s linear infinite;text-shadow:0 0 6px var(--gold);}
@keyframes scrollText{from{transform:translateX(100%);}to{transform:translateX(-100%);}}
</style>
</head>

<body>
<div id="walletInfo" class="wallet">ü¶ä ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...</div>
<img src="logo.png" class="logo" alt="GDSX Logo">
<h1>üí∞ BUY GDSX PRO</h1>
<p>‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç GDSX ‡∏ú‡πà‡∏≤‡∏ô MetaMask ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á<br>‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ 1inch API ‡∏û‡∏£‡πâ‡∏≠‡∏° Proxy ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</p>

<div class="panel">
  <input id="usdtAmount" type="number" placeholder="‡πÉ‡∏™‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô USDT ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ã‡∏∑‡πâ‡∏≠">
  <div class="balances" id="balances">USDT ‚Äì 0 | GDSX ‚Äì 0 | BNB ‚Äì 0</div>
  <button class="buy" onclick="buyGDSX()">üíé SWAP NOW</button><br>
  <button class="back" onclick="location.href='index.html'">‚¨ÖÔ∏è ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
</div>

<div id="toast" class="toast"></div>
<footer><p>üåü GDSX Finance ‚Äî The Future of Digital Gold ‚Ä¢ 2025 üåü</p></footer>

<script>
const USDT="0x55d398326f99059fF775485246999027B3197955";
const GDSX="0xFa9d637329C79bCa321e2Bf0179ae78Bcb3d235a";
const CHAIN_ID=56;
const PROXY="https://api.allorigins.win/raw?url=";

let provider, signer, account;
const $=id=>document.getElementById(id);
function toast(m){const t=$("toast");t.textContent=m;t.classList.add("show");setTimeout(()=>t.classList.remove("show"),3500);}

async function ensureBSC(){
  const hexId="0x38";
  try{
    const cur=await window.ethereum.request({method:"eth_chainId"});
    if(cur.toLowerCase()!==hexId){
      await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:hexId}]});
    }
  }catch(e){
    if(e.code===4902){
      await window.ethereum.request({
        method:"wallet_addEthereumChain",
        params:[{
          chainId:hexId,
          chainName:"BNB Smart Chain",
          nativeCurrency:{name:"BNB",symbol:"BNB",decimals:18},
          rpcUrls:["https://bsc-dataseed.binance.org"],
          blockExplorerUrls:["https://bscscan.com"]
        }]
      });
    }
  }
}

async function connectWallet(){
  if(!window.ethereum){$("walletInfo").textContent="‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ MetaMask";return;}
  await ensureBSC();
  provider=new ethers.providers.Web3Provider(window.ethereum);
  await provider.send("eth_requestAccounts",[]);
  signer=provider.getSigner();
  account=await signer.getAddress();
  $("walletInfo").textContent="ü¶ä "+account.slice(0,6)+"..."+account.slice(-4);
  updateBalances();
}

async function updateBalances(){
  try{
    const [usdtBal,gdsxBal,bnbBal]=await Promise.all([
      new ethers.Contract(USDT,["function balanceOf(address) view returns(uint256)"],signer).balanceOf(account),
      new ethers.Contract(GDSX,["function balanceOf(address) view returns(uint256)"],signer).balanceOf(account),
      provider.getBalance(account)
    ]);
    const usdt=ethers.utils.formatUnits(usdtBal,18);
    const gdsx=ethers.utils.formatUnits(gdsxBal,18);
    const bnb=ethers.utils.formatEther(bnbBal);
    $("balances").textContent=`USDT ‚Äì ${parseFloat(usdt).toFixed(2)} | GDSX ‚Äì ${parseFloat(gdsx).toFixed(2)} | BNB ‚Äì ${parseFloat(bnb).toFixed(4)}`;
  }catch(e){console.log(e);}
}

async function buyGDSX(){
  try{
    if(!signer) await connectWallet();
    const amt=$("usdtAmount").value;
    if(!amt||amt<=0) return toast("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô USDT");
    const amount=ethers.utils.parseUnits(amt,18).toString();

    toast("‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Swap (‡∏ú‡πà‡∏≤‡∏ô Proxy)...");
    const targetUrl=`https://api.1inch.io/v5.0/${CHAIN_ID}/swap?fromTokenAddress=${USDT}&toTokenAddress=${GDSX}&amount=${amount}&fromAddress=${account}&slippage=1`;
    const proxyUrl=PROXY+encodeURIComponent(targetUrl);
    const res=await fetch(proxyUrl);
    const data=await res.json();

    if(!data.tx){toast("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á Swap");return;}
    toast("üí∞ ‡πÄ‡∏õ‡∏¥‡∏î MetaMask ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô...");
    const txHash=await window.ethereum.request({method:'eth_sendTransaction',params:[data.tx]});
    toast(`‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! Tx: ${txHash.slice(0,10)}...`);
    updateBalances();
  }catch(e){
    console.error(e);
    if(e.code===4001) toast("‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÉ‡∏ô MetaMask");
    else toast("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡πÇ‡∏õ‡∏£‡∏î‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà");
  }
}

window.addEventListener("load",()=>{
  if(window.ethereum){
    connectWallet();
    setInterval(()=>{if(account)updateBalances();},30000);
    window.ethereum.on?.('accountsChanged',()=>connectWallet());
    window.ethereum.on?.('chainChanged',()=>location.reload());
  }else{$("walletInfo").textContent="‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ MetaMask";}
});
</script>
</body>
</html>
