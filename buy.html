<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üí∞ BUY GDSX ‚Äî Space Edition</title>
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
<style>
:root { --gold:#ffd700; --neon:#00ffd5; }
body {
  margin:0; padding:0; color:#fff;
  font-family:"Poppins","Noto Sans Thai",sans-serif;
  background:radial-gradient(circle at top,#000 30%,#0a0a1a 90%);
  overflow:hidden; min-height:100vh; text-align:center;
}

/* üåå Moving star background */
@keyframes stars { from{background-position:0 0,0 0;} to{background-position:-10000px 5000px,10000px 5000px;} }
body::before {
  content:""; position:fixed; top:0; left:0; width:200%; height:200%;
  background:url("https://i.ibb.co/6D0tGd6/stars.png") repeat;
  background-size:contain; animation:stars 180s linear infinite;
  opacity:0.25; z-index:-1;
}

h1 {
  color:var(--gold);
  text-shadow:0 0 25px var(--gold),0 0 45px #ffb700;
  margin-top:60px; font-size:2em;
}
.subtitle {
  color:var(--neon);
  text-shadow:0 0 15px var(--neon);
  font-size:1em; margin-bottom:30px;
}

.panel {
  background:rgba(20,20,40,.85);
  border:1px solid var(--gold);
  border-radius:18px;
  width:90%; max-width:400px; margin:auto; padding:25px;
  box-shadow:0 0 25px rgba(255,215,0,.4);
}

.data {
  background:rgba(0,0,0,.5); border:1px solid rgba(255,215,0,.3);
  border-radius:12px; padding:10px; margin:10px 0;
  text-align:left; font-size:.9em;
}
.data span { float:right; color:var(--gold); }

input {
  width:100%; padding:10px; margin-top:10px;
  border-radius:10px; border:1px solid rgba(255,215,0,.4);
  background:#111; color:#fff; text-align:center;
}

button {
  border:none; border-radius:10px; padding:12px 20px;
  margin-top:15px; cursor:pointer; font-weight:700;
  transition:.3s;
}
#swapBtn {
  background:linear-gradient(90deg,#00ffd5,#00cc99);
  color:#000; font-size:1.1em; box-shadow:0 0 20px rgba(0,255,204,.8);
}
#swapBtn:hover { box-shadow:0 0 30px rgba(255,255,255,1); }
#backBtn {
  background:linear-gradient(90deg,#ffcc33,#ffb300);
  color:#000; margin-top:10px;
}
#backBtn:hover { box-shadow:0 0 25px gold; }

footer { margin-top:40px; color:var(--gold); font-size:.9em; }

.toast {
  position:fixed; left:50%; bottom:60px; transform:translateX(-50%);
  background:rgba(20,20,20,.95); border:1px solid var(--gold);
  color:#fff; padding:8px 14px; border-radius:10px;
  box-shadow:0 0 12px rgba(255,215,0,.35);
  display:none; z-index:1600;
}
.toast.show{display:block;}
</style>
</head>
<body>
<h1>üí∞ BUY GDSX</h1>
<p class="subtitle">1 USDT = 10 GDSX ‚Äî The Future of Digital Gold üåå</p>

<div class="panel">
  <div class="data">Wallet <span id="wallet">‚Äî</span></div>
  <div class="data">USDT Balance <span id="usdtBal">0.00</span></div>
  <div class="data">GDSX Balance <span id="gdsxBal">0.00</span></div>
  <div class="data">BNB Balance <span id="bnbBal">0.00</span></div>

  <input type="number" id="amount" placeholder="Enter USDT amount" />

  <button id="swapBtn" onclick="buy()">üöÄ SWAP NOW</button>
  <button id="backBtn" onclick="window.location.href='index.html'">‚Ü©Ô∏è Back to Farm</button>
</div>

<footer>Powered by GDSX Finance ¬© 2025</footer>
<div id="toast" class="toast"></div>

<script>
const PAYMENT="0x247036F7B77861e3aA5bF966466f43D29D3C962d";
const USDT="0x55d398326f99059fF775485246999027B3197955"; // BSC USDT mainnet
const GDSX="0xFa9d637329C79bCa321e2Bf0179ae78Bcb3d235a";
let provider,signer,account,payContract,usdtContract,gdsxContract,decimals=18;

const abiPay=["function buyGDSX(uint256 usdtAmount) public"];
const abiErc20=[
 "function approve(address spender,uint256 amount) external returns(bool)",
 "function balanceOf(address) view returns(uint256)",
 "function decimals() view returns(uint8)",
 "function allowance(address owner,address spender) view returns(uint256)"
];

const $=id=>document.getElementById(id);
function showToast(msg){
 const t=$("toast"); t.textContent=msg;
 t.classList.add("show"); setTimeout(()=>t.classList.remove("show"),2200);
}

async function connect(){
  if(!window.ethereum){alert("Please install MetaMask!");return;}
  provider=new ethers.providers.Web3Provider(window.ethereum);
  await provider.send("eth_requestAccounts",[]);
  signer=provider.getSigner(); account=await signer.getAddress();
  payContract=new ethers.Contract(PAYMENT,abiPay,signer);
  usdtContract=new ethers.Contract(USDT,abiErc20,signer);
  gdsxContract=new ethers.Contract(GDSX,abiErc20,signer);
  $("wallet").textContent=account.slice(0,6)+"..."+account.slice(-4);
  refresh();
}

async function refresh(){
  if(!signer)return;
  const [uBal,gBal,ethBal]=await Promise.all([
    usdtContract.balanceOf(account),
    gdsxContract.balanceOf(account),
    provider.getBalance(account)
  ]);
  $("usdtBal").textContent=(parseFloat(ethers.utils.formatUnits(uBal,18))).toFixed(2);
  $("gdsxBal").textContent=(parseFloat(ethers.utils.formatUnits(gBal,18))).toFixed(2);
  $("bnbBal").textContent=(parseFloat(ethers.utils.formatUnits(ethBal,18))).toFixed(4);
}

async function buy(){
  if(!signer)return connect();
  const val=$("amount").value;
  if(!val||Number(val)<=0)return showToast("Enter amount");
  const amt=ethers.utils.parseUnits(val,18);
  try{
    // Approve USDT
    const allowance=await usdtContract.allowance(account,PAYMENT);
    if(allowance.lt(amt)){
      showToast("üîì Approving USDT...");
      const tx1=await usdtContract.approve(PAYMENT,ethers.constants.MaxUint256);
      await tx1.wait(); showToast("‚úÖ Approved!");
    }
    showToast("üí∞ Swapping...");
    const tx2=await payContract.buyGDSX(amt);
    await tx2.wait();
    showToast("‚úÖ Swap success!");
    refresh();
  }catch(e){console.error(e);showToast("Swap failed ‚ùå");}
}

window.addEventListener("load",connect);
</script>
</body>
</html>
