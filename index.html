<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üåæ MGX FARM ULTRA++</title>
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
<style>
:root { --gold:#ffd700; --neon:#00ffd5; }
body {
  background: radial-gradient(circle at top,#000 40%,#111 100%);
  color:#fff; font-family:"Poppins","Noto Sans Thai",sans-serif;
  text-align:center; overflow-x:hidden; min-height:100vh; margin:0;
}
.logo {
  width:90px; height:90px; border-radius:50%;
  object-fit:cover; margin-top:25px;
  box-shadow:0 0 30px rgba(255,215,0,0.8);
  animation:spin 10s linear infinite;
}
@keyframes spin {from{transform:rotate(0)}to{transform:rotate(360deg)}}
h1 {color:var(--gold);text-shadow:0 0 10px rgba(255,215,0,.6);font-size:1.8em;margin-top:10px;}
.subtitle {color:var(--neon);font-size:.9em;margin-bottom:15px;}
.panel {
  background:rgba(20,20,20,.85);border:1px solid var(--gold);
  border-radius:16px;padding:20px;margin:10px auto 100px auto;
  width:90%;max-width:420px;box-shadow:0 0 15px rgba(255,215,0,.3);
  transition:box-shadow 0.3s ease;
}
.data-box {display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:10px;}
.box {
  background:rgba(10,10,10,.7);border:1px solid rgba(255,215,0,.3);
  border-radius:10px;padding:8px;font-size:.9em;
}
.box span {color:var(--gold);display:block;margin-top:4px;font-weight:600;}
#reward {
  color:#ffd700;font-weight:700;
  text-shadow:0 0 6px #ffec80,0 0 18px #ffd700,0 0 28px #fff4b0;
  animation:rewardGlow 1.5s infinite alternate;
}
@keyframes rewardGlow {
  from{text-shadow:0 0 6px #ffec80,0 0 16px #ffd700;}
  to{text-shadow:0 0 20px #fff4b0,0 0 35px #ffe066;}
}
input {
  width:100%;padding:10px;margin-top:8px;border-radius:10px;
  border:1px solid rgba(255,215,0,.3);text-align:center;
  background:#111;color:#fff;
}
button {
  background:linear-gradient(90deg,#222,#444);
  color:var(--gold);border:1px solid var(--gold);
  border-radius:10px;padding:10px 20px;margin:5px;cursor:pointer;
  transition:.3s;
}
button:hover {background:rgba(255,215,0,0.2);}
button.claim {
  background:linear-gradient(90deg,#ffb300,#ffcc33);
  color:#111;font-weight:700;border:none;border-radius:12px;
  padding:10px 20px;cursor:pointer;
  box-shadow:0 0 20px rgba(255,215,0,.85);
  animation:claimPulse 2s ease-in-out infinite alternate;
}
@keyframes claimPulse {
  from{box-shadow:0 0 12px rgba(255,215,0,.5);}
  to{box-shadow:0 0 30px rgba(255,255,140,1);}
}
.buy {
  background:linear-gradient(90deg,#00ffcc,#00cc99);
  color:#111;font-weight:700;border:none;border-radius:12px;
  padding:10px 20px;cursor:pointer;box-shadow:0 0 20px rgba(0,255,204,.7);
}
footer {
  position:fixed;bottom:0;background:#111;border-top:2px solid rgba(255,215,0,0.5);
  width:100%;overflow:hidden;height:30px;
}
footer p {
  display:inline-block;white-space:nowrap;color:var(--gold);font-weight:600;font-size:.9em;
  animation:scrollText 18s linear infinite;text-shadow:0 0 6px var(--gold);margin-top:2px;
}
@keyframes scrollText {from{transform:translateX(100%);}to{transform:translateX(-100%);} }
.toast {
  position:fixed;left:50%;bottom:60px;transform:translateX(-50%);
  background:rgba(20,20,20,.95);border:1px solid var(--gold);
  color:#fff;padding:8px 14px;border-radius:10px;
  box-shadow:0 0 12px rgba(255,215,0,.35);
  display:none;z-index:1600;
}
.toast.show{display:block;}
.connect-btn {
  position:fixed;top:12px;right:15px;width:55px;height:55px;
  border-radius:50%;border:none;cursor:pointer;
  background:radial-gradient(circle,#ffcc33 10%,#b8860b 80%);
  box-shadow:0 0 20px rgba(255,215,0,0.8);
  animation:btnPulse 2s infinite alternate;
}
@keyframes btnPulse {from{box-shadow:0 0 10px rgba(255,215,0,0.5);}to{box-shadow:0 0 25px rgba(255,255,150,1);} }
.connect-btn:after {content:"ü™ô";font-size:22px;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);}
.lang-btn {
  position:fixed;top:18px;left:15px;background:#222;color:var(--gold);
  border:1px solid var(--gold);border-radius:8px;padding:5px 10px;cursor:pointer;font-size:.9em;
}
.menu-toggle {
  position:fixed;top:18px;right:80px;
  font-size:26px;color:var(--gold);cursor:pointer;
}
.popup-menu {
  position:fixed;top:0;right:-250px;
  width:250px;height:100%;
  background:rgba(20,20,20,.95);
  border-left:2px solid var(--gold);
  display:flex;flex-direction:column;
  justify-content:center;
  transition:.4s;z-index:1500;
}
.popup-menu.active{right:0;}
.popup-menu a{
  color:var(--gold);text-decoration:none;
  padding:12px 20px;
  border-bottom:1px solid rgba(255,215,0,.3);
  transition:all .3s ease;
}
.popup-menu a:hover{
  background:rgba(255,215,0,0.1);
  text-shadow:0 0 12px #ffd700;
}
.powered {margin-top:10px;color:var(--gold);font-size:.9em;}
.game-center-btn {
  background:linear-gradient(90deg,#ffd700,#ffb400);
  color:#000;font-weight:700;border:none;border-radius:12px;
  padding:10px 20px;margin-top:10px;cursor:pointer;
  text-decoration:none;display:inline-block;
  box-shadow:0 0 15px rgba(255,215,0,0.8);
  transition:.3s;
}
.game-center-btn:hover {box-shadow:0 0 30px rgba(255,255,150,1);}
@keyframes shine {
  from { text-shadow:0 0 8px #ffd700,0 0 16px #ffb700; }
  to { text-shadow:0 0 20px #fff4a0,0 0 30px #ffe066; }
}
/* üåü Airdrop Popup */
#popup {
  display:none;position:fixed;top:50%;left:50%;
  transform:translate(-50%,-50%);
  background:radial-gradient(circle at center,#111 20%,#000 90%);
  border:2px solid gold;border-radius:15px;padding:30px;
  text-align:center;color:#ffd700;
  box-shadow:0 0 40px gold;z-index:9999;
  width:80%;max-width:350px;animation:glow 2s infinite alternate;
}
@keyframes glow {from{box-shadow:0 0 15px gold;}to{box-shadow:0 0 30px #ffcc00;}}
#popup h2 {font-size:1.4em;margin-bottom:10px;text-shadow:0 0 15px gold;}
#popup p {font-size:0.95em;line-height:1.4em;color:#fff;}
#popup button {
  background:gold;color:#000;border:none;
  padding:10px 25px;border-radius:10px;font-weight:bold;
  margin-top:15px;box-shadow:0 0 20px gold;cursor:pointer;
}
</style>
</head>

<body>
<img class="logo" src="logo.png" alt="GDSX Logo">
<h1>üåæ MGX FARM ULTRA++</h1>
<p class="subtitle">The Future of Digital Gold ‚Äî ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•‡πÅ‡∏´‡πà‡∏á‡∏¢‡∏∏‡∏Ñ‡πÉ‡∏´‡∏°‡πà</p>

<div class="menu-toggle" onclick="toggleMenu()">‚ò∞</div>
<div class="popup-menu" id="popupMenu">
  <a href="#">üåæ Farm</a>
  <a href="#">üí∞ Treasury</a>
  <a href="https://gdsxfinance.github.io/game.html" target="_blank">üéÆ MGX Game Center</a>
  <a href="https://gdsxfinance.github.io/gdsx_fortune_intro.html" target="_blank"
     style="color:#ffd700;text-shadow:0 0 8px #ffea70;font-weight:600;animation:shine 2s infinite alternate;">üé¥ ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏ã‡∏µ‡∏¢‡∏°‡∏ã‡∏µ GDSX</a>
  <a href="https://gdsxfinance.github.io/whitepaper.html" target="_blank">üìò Whitepaper (EN/TH)</a>
  <a href="javascript:void(0)" onclick="showAirdropComingSoon()">üéà Airdrop</a>
  <a href="community.html" class="menu-item">üí¨ Community</a>
</div>

<button class="connect-btn" onclick="connect()"></button>
<button class="lang-btn" id="lang-btn" onclick="toggleLang()">EN</button>

<div class="panel" id="panelBox">
  <div class="data-box">
    <div class="box" id="walletBox">Wallet<span id="wallet">‚Äî</span></div>
    <div class="box" id="totalBox">Total MGX<span id="totalGdsx">0.0000</span></div>
    <div class="box" id="stakeBox">Your Stake<span id="stake">0.0000</span></div>
    <div class="box" id="rewardBox">Pending Rewards<span id="reward">0.0000</span><small id="rewardUsd">‚âà ‚Äî USD</small></div>
  </div>

  <input type="number" id="amount" placeholder="Enter amount MGX">

  <div>
    <button id="btnDeposit" onclick="deposit()">Deposit</button>
    <button id="btnWithdraw" onclick="withdraw()">Withdraw</button>
    <button class="claim" id="btnClaim" onclick="claim()">Claim</button>
    <button class="buy" id="btnBuy" onclick="window.location.href='https://gdsxfinance.github.io/buy-pro.html'">üí∞ BUY MGX</button>
    <a href="https://gdsxfinance.github.io/game.html" target="_blank" class="game-center-btn">üéÆ MGX Game Center</a>
    <button id="btnRefresh" onclick="refresh()">Refresh</button>
  </div>
  <div class="powered">Powered by MGX Finance ¬© 2025</div>
</div>

<footer><p>üåü ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•‡πÅ‡∏´‡πà‡∏á‡∏¢‡∏∏‡∏Ñ‡πÉ‡∏´‡∏°‡πà ‚Ä¢ The Future of Digital Gold üåü</p></footer>
<div id="toast" class="toast"></div>

<!-- ‚úÖ Airdrop Popup -->
<div id="popup">
  <h2 id="popup-title">üöÄ Airdrop Coming Soon!</h2>
  <p id="popup-text">
    Join early and be part of the next revolution in <b>Digital Gold</b>.<br>
    The future belongs to those who believe early. üíé
  </p>
  <button onclick="closePopup()">OK</button>
</div>
<script>
const TOKEN="0xc2B5cf3312C532B628A2e510f4653B844c1597A9";
const TREASURY="0x0a12e0c7180b0f5804789c06912d864af486ea77";
const STAKING="0xa63Dbdd62E482633F8Ee7F240ed311Eb974120D3";
let provider,signer,account,token,staking,decimals=18,lang="en";

const abiToken=[
"function approve(address spender,uint256 amount) external returns(bool)",
"function balanceOf(address) view returns(uint256)",
"function allowance(address owner,address spender) view returns(uint256)"
];

const abiStaking=[
"function deposit(uint256 amount) external",
"function withdraw(uint256 amount) external",
"function users(address) view returns (uint256 amount,uint256 rewardDebt)",
"function pendingReward(address userAddr) view returns (uint256)"
];

const $=id=>document.getElementById(id);

function showToast(msg){
  const t=$("toast");
  t.textContent=msg;
  t.classList.add("show");
  setTimeout(()=>t.classList.remove("show"),2200);
}

async function connect(){
  try{
    if(!window.ethereum) return alert("Please install MetaMask");

    provider=new ethers.providers.Web3Provider(window.ethereum);
    await provider.send("eth_requestAccounts",[]);
    signer=provider.getSigner();
    account=await signer.getAddress();

    token = new ethers.Contract(TOKEN, abiToken, signer);
    staking = new ethers.Contract(STAKING, abiStaking, signer);

    $("wallet").textContent=account.slice(0,6)+"..."+account.slice(-4);
    showToast("Wallet Connected");
    refresh();
  }catch(err){
    console.error(err);
    showToast("Connection cancelled");
  }
}

async function refresh(){
  if(!signer) return;

  showToast("Updating...");

  const [userData, pending, walletBal] = await Promise.all([
    staking.users(account),
    staking.pendingReward(account),
    token.balanceOf(account)
  ]);

  $("stake").textContent = parseFloat(ethers.utils.formatUnits(userData.amount,18)).toFixed(4);
  $("reward").textContent = parseFloat(ethers.utils.formatUnits(pending,18)).toFixed(4);
  $("totalGdsx").textContent = parseFloat(ethers.utils.formatUnits(walletBal,18)).toFixed(4);
}

async function deposit(){
  if(!signer) return connect();

  const val = $("amount").value;
  if(!val || Number(val) <= 0) return showToast("Enter amount");

  const amt = ethers.utils.parseUnits(val, decimals);

  try{
    // APPROVE
    const allowance = await token.allowance(account, STAKING);
    if (allowance.lt(amt)) {
      showToast("Approving GDSX...");
      const tx = await token.approve(STAKING, ethers.constants.MaxUint256);
      await tx.wait();
    }

    // DEPOSIT
    showToast("Depositing...");
    const tx2 = await staking.deposit(amt);
    await tx2.wait();

    showToast("Deposit Success");
    refresh();
  }catch(err){
    console.error(err);
    showToast("Deposit failed");
  }
}

async function withdraw(){
  if(!signer) return connect();
  const val = $("amount").value;
  if(!val || Number(val) <= 0) return showToast("Enter amount");

  const amt = ethers.utils.parseUnits(val, decimals);

  try{
    showToast("Withdrawing...");
    const tx = await staking.withdraw(amt);
    await tx.wait();

    showToast("Withdraw Success");
    refresh();
  }catch(err){
    console.error(err);
    showToast("Withdraw failed");
  }
}

async function claim(){
  if(!signer) return connect();

  try{
    showToast("Claiming rewards...");
    const tx = await staking.withdraw(0);
    await tx.wait();

    showToast("Claim success");
    refresh();
  }catch(err){
    console.error(err);
    showToast("Claim failed");
  }
}
</script>
</body>
</html>
